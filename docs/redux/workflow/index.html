<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Notebook collections"><link href=https://abhaydgarg.github.io/Notebook/index.html/redux/workflow/ rel=canonical><meta name=author content="Abhay Garg"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>State mutation workflow - Notebook</title><link rel=stylesheet href=../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#state-mutation-workflow tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Notebook </span> <span class=md-header-nav__topic> State mutation workflow </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-nav__button md-logo"> <i class=md-icon></i> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer-science/ title=CS class=md-nav__link> CS </a> </li> <li class=md-nav__item> <a href=../../parser/ title=Parser class=md-nav__link> Parser </a> </li> <li class=md-nav__item> <a href=../../data-structure-and-algorithms/ title="Data Structure and Algorithms" class=md-nav__link> Data Structure and Algorithms </a> </li> <li class=md-nav__item> <a href=../../oops/ title=OOPS class=md-nav__link> OOPS </a> </li> <li class=md-nav__item> <a href=../../design-patterns/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../regex/ title=Regex class=md-nav__link> Regex </a> </li> <li class=md-nav__item> <a href=../../git/ title=GIT class=md-nav__link> GIT </a> </li> <li class=md-nav__item> <a href=../../css/ title=CSS class=md-nav__link> CSS </a> </li> <li class=md-nav__item> <a href=../../rest-api/ title="REST API" class=md-nav__link> REST API </a> </li> <li class=md-nav__item> <a href=../../javascript/ title=Javascript class=md-nav__link> Javascript </a> </li> <li class=md-nav__item> <a href=../../nodejs/ title=Node.js class=md-nav__link> Node.js </a> </li> <li class=md-nav__item> <a href=../../npm/ title=NPM class=md-nav__link> NPM </a> </li> <li class=md-nav__item> <a href=../ title=Redux class=md-nav__link> Redux </a> </li> <li class=md-nav__item> <a href=../../react/ title=React class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../react-native/ title="React Native" class=md-nav__link> React Native </a> </li> <li class=md-nav__item> <a href=../../mongodb/ title=MongoDB class=md-nav__link> MongoDB </a> </li> <li class=md-nav__item> <a href=../../web-security/ title="Web Security" class=md-nav__link> Web Security </a> </li> <li class=md-nav__item> <a href=../../rust/ title=Rust class=md-nav__link> Rust </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#rely-on-api-only class=md-nav__link> Rely on API ONLY </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get class=md-nav__link> Get </a> </li> <li class=md-nav__item> <a href=#create class=md-nav__link> Create </a> </li> <li class=md-nav__item> <a href=#update class=md-nav__link> Update </a> </li> <li class=md-nav__item> <a href=#delete class=md-nav__link> Delete </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#use-state-as-proxy-and-send-api-request-when-required class=md-nav__link> Use state as proxy and send API request when required </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-allpartial class=md-nav__link> Get (all/partial) </a> </li> <li class=md-nav__item> <a href=#get-single-record class=md-nav__link> Get (single record) </a> </li> <li class=md-nav__item> <a href=#create_1 class=md-nav__link> Create </a> </li> <li class=md-nav__item> <a href=#update_1 class=md-nav__link> Update </a> </li> <li class=md-nav__item> <a href=#delete_1 class=md-nav__link> Delete </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#questions class=md-nav__link> Questions </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#on-create-and-update-if-api-does-not-send-anything-back-then-instead-of-re-fetching-whole-data-can-we-use-the-post-data-of-request-to-update-the-state class=md-nav__link> On create and update, if API does not send anything back then instead of re-fetching whole data. Can we use the post data of request to update the state? </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/abhaydgarg/Notebook/tree/master/src/redux/workflow.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=state-mutation-workflow>State mutation workflow<a class=headerlink href=#state-mutation-workflow title="Permanent link">&para;</a></h1> <p><strong>Question:</strong> When to use API and when should API be skipped? Should use API heavily or should use state directly and use API to refetch data as less as possible, only when required?</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>You have to evaluate which approach should be used based upon your app. <strong>OR</strong> you can also go for mixed approaches.</p> </div> <h2 id=rely-on-api-only>Rely on API ONLY<a class=headerlink href=#rely-on-api-only title="Permanent link">&para;</a></h2> <blockquote> <p>Logic is <strong>HIGHLY DEPENDS</strong> upon the api response.</p> </blockquote> <ul> <li><strong>Benefit:</strong> Reducer's logic will be simpler with less code.</li> <li><strong>Drawback:</strong> Increase API usage, that is, increase number of request to API.</li> </ul> <h3 id=get>Get<a class=headerlink href=#get title="Permanent link">&para;</a></h3> <p>For get request it does not matter because the data has to be fetched from the API.</p> <h3 id=create>Create<a class=headerlink href=#create title="Permanent link">&para;</a></h3> <ol> <li>Record is created successfully.</li> <li>There could be 3 scenarios based on API response.<ol> <li>API sends newly created record in response. Then we can directly add that record in our state.</li> <li>API sends ID of newly created record. Then we can send request to API to fetch the data of single record by ID rather than whole list and then add it to the state.</li> <li>API does not send anything. Then we have to refetch whole list.</li> </ol> </li> </ol> <h3 id=update>Update<a class=headerlink href=#update title="Permanent link">&para;</a></h3> <ol> <li>Record is updated successfully.</li> <li>There could be 2 scenarios based on API response.<ol> <li>API sends updated record in response. Then we can directly update that record in our state.</li> <li>API does not send anything. But we have ID with us. Then we can send request to API to fetch the data of single record by ID rather than whole list and then update the state.</li> </ol> </li> </ol> <h3 id=delete>Delete<a class=headerlink href=#delete title="Permanent link">&para;</a></h3> <ol> <li>Record(s) are deleted successfully.</li> <li>There could be 2 scenarios.<ol> <li>API deos not send back anything. But we already have list of deleted IDs. On complete success we can simply remove entries from state. But if some of them are failed and some of them are succeeded then in this case we can re-fetch whole list to remove failed entries from state.</li> <li>API sends back ID of deleted records. In this case, handling scenario when some of them are failed and some of them are succeeded can be easy. Because we can have list of succeeded ids that we can use to remove entries from state and let the failed one untouched. We do not need to fetch whole list again.</li> </ol> </li> </ol> <h2 id=use-state-as-proxy-and-send-api-request-when-required>Use state as proxy and send API request when required<a class=headerlink href=#use-state-as-proxy-and-send-api-request-when-required title="Permanent link">&para;</a></h2> <div class="admonition note"> <p class=admonition-title>2 places to make decision</p> <ol> <li>In saga. But it should be avoided unless no other option. Because in this case, we have to handle the <code>loader</code> which is set <code>on</code> on request. Or we can use initial action say <code>getPostsInitialize</code> which dermine if request be sent or skipped.</li> <li>In component. This is recommended approach. You can make that decision in <code>useEffect</code> hook. And avoid creating extra <code>Initialize</code> action.</li> </ol> </div> <blockquote> <p>Steps below are conceptualized in <strong>BROWSER ENVIRONMENT</strong>.</p> </blockquote> <h3 id=get-allpartial>Get (all/partial)<a class=headerlink href=#get-allpartial title="Permanent link">&para;</a></h3> <p>Tha data has to be fetched from API when action is triggered.</p> <h3 id=get-single-record>Get (single record)<a class=headerlink href=#get-single-record title="Permanent link">&para;</a></h3> <p>Tha data has to be fetched from API when action is triggered. But in success's reducer function you have to handle two scenarios.</p> <ol> <li>When record is created. You add new record to the list.</li> <li>When record is updated. You update record already existed in the list.</li> </ol> <h3 id=create_1>Create<a class=headerlink href=#create_1 title="Permanent link">&para;</a></h3> <ol> <li>Either open page by url directly or by clicking on link.</li> <li>Record is created successfully.</li> <li>Based on API response.<ul> <li>In component, In success function. If get an id back in response and list has been fetched already, then fetch the created record and add it to the list. Basically, <strong>trigger get single record request action</strong>, which will also handle the logic of adding record to the list.</li> <li>In component, In success function. If does not get an id back in response then re-fetch the whole list. Basically, <strong>trigger get all (or partial-based on pagination) records request action.</strong></li> </ul> </li> </ol> <h3 id=update_1>Update<a class=headerlink href=#update_1 title="Permanent link">&para;</a></h3> <blockquote> <p>You can have refresh button somewhere on header/top which fetches the fresh copy from API.</p> </blockquote> <ol> <li>Either open page by url directly or by clicking on link. In <code>useEffect</code> check if you are already recieving a record from selector then do not send request otherwise send the request.</li> <li>Record is updated successfully.</li> <li>In component, In success function. You already have an id of updated record. So send a request to fetch updated data from API and update the existed record. Basically, <strong>trigger get single record request action</strong>, which handle the record update operation too.</li> </ol> <h3 id=delete_1>Delete<a class=headerlink href=#delete_1 title="Permanent link">&para;</a></h3> <ol> <li>Either single or multiple records are deleted successfully.</li> <li>Delete the records from the state's list only. In most cases, you do not have to re-fetch list from API. Deleting from state will do. But for some complex list you may need to re-fetch the list after perfoming delete operation.<ul> <li>In case of multiple records, if any request is failed then re-fetch the list from API to keep it synchronised rather than perfoming logic of removing only records that are successfully removed.</li> </ul> </li> </ol> <h2 id=questions>Questions<a class=headerlink href=#questions title="Permanent link">&para;</a></h2> <h3 id=on-create-and-update-if-api-does-not-send-anything-back-then-instead-of-re-fetching-whole-data-can-we-use-the-post-data-of-request-to-update-the-state>On create and update, if API does not send anything back then instead of re-fetching whole data. Can we use the post data of request to update the state?<a class=headerlink href=#on-create-and-update-if-api-does-not-send-anything-back-then-instead-of-re-fetching-whole-data-can-we-use-the-post-data-of-request-to-update-the-state title="Permanent link">&para;</a></h3> <p>This can be done if the post data model in request is exactly identical with reponse data model from API when using <code>GET</code>. Not only the keys' name but values too. For example, if you get <code>createdOn</code> field in response which has value in milliseconds then in request we have to send <code>createdOn</code> field in milliseconds. But this is absurd and not feasible. If you go by this then you are just <strong>tightly couple</strong> the API with frontend.</p> <p>Also, this approach is not feasible in real world applications. Because we transform response/request and the reponse that we get from API can have additional fields that are attached to reponse on backend like <code>createdOn</code>, <code>createdBy</code> etc. Also, the value send in request is computed on backend and then on reponse you will get different value.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>I mean this is stupid, if you try to build your logic like that because you do not want to re-fetch whole list. This appraoch invites all kind unknown scenarios to handle in order to keep data synchronise with backend. Which is more costly than fetching whole list again and process it again. Also, by this way, you will be handling all kind of conditions in your code rather than focusing on implementing business logic correctly.</p> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Abhay Garg </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>