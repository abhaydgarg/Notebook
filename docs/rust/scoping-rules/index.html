<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Notebook collections"><link href=https://abhaydgarg.github.io/Notebook/index.html/rust/scoping-rules/ rel=canonical><meta name=author content="Abhay Garg"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>Scoping rules - Notebook</title><link rel=stylesheet href=../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#scoping-rules tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Notebook </span> <span class=md-header-nav__topic> Scoping rules </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-nav__button md-logo"> <i class=md-icon></i> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer-science/ title=CS class=md-nav__link> CS </a> </li> <li class=md-nav__item> <a href=../../parser/ title=Parser class=md-nav__link> Parser </a> </li> <li class=md-nav__item> <a href=../../data-structure-and-algorithms/ title="Data structure and algorithms" class=md-nav__link> Data structure and algorithms </a> </li> <li class=md-nav__item> <a href=../../oops/ title=OOPS class=md-nav__link> OOPS </a> </li> <li class=md-nav__item> <a href=../../design-patterns/ title="Design patterns" class=md-nav__link> Design patterns </a> </li> <li class=md-nav__item> <a href=../../regex/ title=Regex class=md-nav__link> Regex </a> </li> <li class=md-nav__item> <a href=../../git/ title=GIT class=md-nav__link> GIT </a> </li> <li class=md-nav__item> <a href=../../css/ title=CSS class=md-nav__link> CSS </a> </li> <li class=md-nav__item> <a href=../../mysql/ title=MySQL class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../mongodb/ title=MongoDB class=md-nav__link> MongoDB </a> </li> <li class=md-nav__item> <a href=../../javascript/ title=Javascript class=md-nav__link> Javascript </a> </li> <li class=md-nav__item> <a href=../../nodejs/ title=Node.js class=md-nav__link> Node.js </a> </li> <li class=md-nav__item> <a href=../../expressjs/ title=Express.js class=md-nav__link> Express.js </a> </li> <li class=md-nav__item> <a href=../../react/ title=React class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../linters/ title=Linters class=md-nav__link> Linters </a> </li> <li class=md-nav__item> <a href=../../graphql/ title=GraphQL class=md-nav__link> GraphQL </a> </li> <li class=md-nav__item> <a href=../../redux-saga/ title="Redux saga" class=md-nav__link> Redux saga </a> </li> <li class=md-nav__item> <a href=../../rxjs/ title=RxJS class=md-nav__link> RxJS </a> </li> <li class=md-nav__item> <a href=../../typescript/ title=Typescript class=md-nav__link> Typescript </a> </li> <li class=md-nav__item> <a href=../../web-security/ title="Web security" class=md-nav__link> Web security </a> </li> <li class=md-nav__item> <a href=../../react-native/ title="React native" class=md-nav__link> React native </a> </li> <li class=md-nav__item> <a href=../ title=Rust class=md-nav__link> Rust </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#memory-management class=md-nav__link> Memory management </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implicit class=md-nav__link> Implicit </a> </li> <li class=md-nav__item> <a href=#explicit class=md-nav__link> Explicit </a> </li> <li class=md-nav__item> <a href=#freeing-dynamic-memory class=md-nav__link> Freeing dynamic memory </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#memory-and-other-programming-languages class=md-nav__link> Memory and other programming languages </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#primitive-types class=md-nav__link> Primitive types </a> </li> <li class=md-nav__item> <a href=#non-primitive-types class=md-nav__link> Non-primitive types </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/abhaydgarg/Notebook/tree/master/src/rust/scoping-rules.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=scoping-rules>Scoping rules<a class=headerlink href=#scoping-rules title="Permanent link">&para;</a></h1> <p>Scopes play an important part in ownership, borrowing, and lifetimes. That is, they indicate to the compiler when borrows are valid, when resources can be freed, and when variables are created or destroyed.</p> <h2 id=memory-management>Memory management<a class=headerlink href=#memory-management title="Permanent link">&para;</a></h2> <p>In every application, you must allocate new storage before you can use it, and then you must return all such storage to the operating system when you are finished. While some languages handle all of this for you, lower-level languages like C or C++ sometimes require more effort by the programmer to manage memory. There are several ways to do this: implicit and explicit.</p> <h3 id=implicit>Implicit<a class=headerlink href=#implicit title="Permanent link">&para;</a></h3> <p>Implicit memory allocation is memory that is allocated, typically on the system stack, by the compiler. This occurs when you create a new variable:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kt>void</span> <span class=nf>my_func</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=n>x</span><span class=p>;</span>
  <span class=kt>char</span> <span class=n>y</span><span class=p>;</span>
  <span class=kt>int</span> <span class=n>z</span><span class=p>[</span><span class=mi>25</span><span class=p>];</span>
  <span class=p>...</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Here, space is allocated on the system stack for the variables <code>x</code>, <code>y</code> and <code>z</code> when the function is called, and the space is reclaimed automatically when the function exits.</p> <h3 id=explicit>Explicit<a class=headerlink href=#explicit title="Permanent link">&para;</a></h3> <p>Explicit memory allocation occurs through pointers, and calls to the memory management functions.</p> <p>There are also many places where memory needs to be created in a size which is not known at compile-time. Consider a web browser that needs to allocate enough storage to store the downloaded HTML text of a webpage. Since webpages can be all different sizes, we can't possibly know the sizes of them all when we compile, we must allocate the storage at runtime with pointer or an equivalent.</p> <blockquote> <p>Memory that is allocated on the stack and is fixed in size and scope is called <strong>static</strong>. Memory that uses pointer to be allocated at run time is called <strong>dynamic</strong>.</p> </blockquote> <h3 id=freeing-dynamic-memory>Freeing dynamic memory<a class=headerlink href=#freeing-dynamic-memory title="Permanent link">&para;</a></h3> <p>When you allocate memory from the heap using <code>malloc</code> or something similar, you obtain a pointer to allocated memory from the system. When you are done with it, you must free the memory, to return it back to the system. Failure to return all the memory that you allocate is called a <strong>memory leak</strong>.</p> <p>When you allocate memory, you must always be careful to release your allocated memory back to the system. Herein is the problem: if your system is complicated and needs to allocate many small chunks of memory, you need to be certain to free all those individual little chunks as well. This can be all the more difficult if you are in a dynamic situation where memory is being allocated and deallocated continuously, and memory chunks must stay available for random lengths of time.</p> <p>To overcome these complications automatic memory manager systems, such as garbage collectors, can be employed to try to automate the memory allocations and deallocations.</p> <h2 id=memory-and-other-programming-languages>Memory and other programming languages<a class=headerlink href=#memory-and-other-programming-languages title="Permanent link">&para;</a></h2> <p>C and C++ give a total control to programmer to handle memory allocation and deallocation. They do not have garabage collector.</p> <p>Let's understand the memory allocation and removal through <strong>Javascript language</strong> which uses garabage collector to free unused memory space.</p> <blockquote> <p>Most other languages such as Java, PHP etc uses almost the same concept for handling primitive and non-primitive data types.</p> </blockquote> <h3 id=primitive-types>Primitive types<a class=headerlink href=#primitive-types title="Permanent link">&para;</a></h3> <ul> <li>Store in stack (Execution context).</li> <li>Destoryed when stack is removed from the stack frame.</li> <li>Uses <strong>copy by value</strong> mechanism when assign to variable and pass variable to function as parameter.</li> </ul> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// the value of a is copied to b.</span>
<span class=c1>// a and b has their own separate copy of</span>
<span class=c1>// value 1.</span>
<span class=kd>let</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<span class=kd>let</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>;</span>

<span class=c1>// reassign a</span>
<span class=nx>a</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=c1>// 1</span>

<span class=c1>//# Function parameters</span>
<span class=c1>// Copy first then pass</span>
<span class=c1>// own separate copy of values</span>
<span class=c1>// to function.</span>
<span class=kd>function</span> <span class=nx>add</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Changing a or b here</span>
  <span class=c1>// do not affect a and b variables</span>
  <span class=c1>// outside the function because they</span>
  <span class=c1>// have been copied.</span>
  <span class=k>return</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>;</span>
<span class=p>}</span>

<span class=kd>let</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<span class=kd>let</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
<span class=c1>// a and b passed to function</span>
<span class=c1>// are first copied and then passed.</span>
<span class=c1>// This is IMPLICITLY or automatically</span>
<span class=c1>// done by javascript.</span>
<span class=kd>let</span> <span class=nx>sum</span> <span class=o>=</span> <span class=nx>add</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>);</span>
</pre></div> </td></tr></table> <h3 id=non-primitive-types>Non-primitive types<a class=headerlink href=#non-primitive-types title="Permanent link">&para;</a></h3> <ul> <li>Store in heap.</li> <li>Reference or pointer which points to the memory location in heap is stored in stack in a variable.</li> <li>Pointer is destoryed when stack is removed from the stack frame. Which does not remove memory from heap therefore garabage collector runs time ot time in order to remove unused memory which has no pointer back in stack frame.</li> <li>Uses <a href=https://abhaydgarg.github.io/Notebook/javascript/js/reference-concept/ ><strong>by share</strong></a> mechanism when assign to variable and pass variable to function as parameter.</li> <li>By share mechanism because non-primitive types can have large data associated with them so making a multiple copy and store ina heap is a wastage of space and has performance set back because now we have to maintain or keep all the copies in sync.</li> </ul> <blockquote> <p>Object and Array are non-primitive types in javascript.</p> </blockquote> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// the value of a is actually a pointer</span>
<span class=c1>// or address of memory location in heap</span>
<span class=c1>// where a is stored. Assign a to b copy the</span>
<span class=c1>// memory address to b.</span>
<span class=kd>let</span> <span class=nx>a</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>x</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>y</span><span class=o>:</span> <span class=mi>2</span><span class=p>};</span>
<span class=kd>let</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>;</span>

<span class=c1>// Changes both a and b</span>
<span class=c1>// because both have same</span>
<span class=c1>// memory address.</span>
<span class=nx>a</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=c1>// { x: 2, y: 2}</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=c1>// { x: 2, y: 2}</span>

<span class=c1>// reassign a, which does not</span>
<span class=c1>// change the memory address stored in</span>
<span class=c1>// b because both a and b have their own</span>
<span class=c1>// separate copy of memory address.</span>
<span class=c1>// This is called `by share` mechanism.</span>
<span class=nx>a</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=c1>// null</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=c1>// { x: 2, y: 2}</span>

<span class=c1>//# Function parameter</span>
<span class=kd>function</span> <span class=nx>fn</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Changing a here do affect a variable</span>
  <span class=c1>// outside the function.</span>
  <span class=nx>a</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
<span class=p>}</span>
<span class=kd>let</span> <span class=nx>a</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>x</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>y</span><span class=o>:</span> <span class=mi>2</span><span class=p>};</span>
<span class=nx>fn</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=c1>// { x: 2, y: 2}</span>
</pre></div> </td></tr></table> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Abhay Garg </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>