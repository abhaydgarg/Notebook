<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Notebook collections"><link href=https://abhaydgarg.github.io/Notebook/index.html/javascript/js/reference-concept/ rel=canonical><meta name=author content="Abhay Garg"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>Reference concept - Notebook</title><link rel=stylesheet href=../../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#reference-concept tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Notebook </span> <span class=md-header-nav__topic> Reference concept </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-nav__button md-logo"> <i class=md-icon></i> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../computer-science/ title=CS class=md-nav__link> CS </a> </li> <li class=md-nav__item> <a href=../../../parser/ title=Parser class=md-nav__link> Parser </a> </li> <li class=md-nav__item> <a href=../../../data-structure-and-algorithms/ title="Data Structure and Algorithms" class=md-nav__link> Data Structure and Algorithms </a> </li> <li class=md-nav__item> <a href=../../../oops/ title=OOPS class=md-nav__link> OOPS </a> </li> <li class=md-nav__item> <a href=../../../design-patterns/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../regex/ title=Regex class=md-nav__link> Regex </a> </li> <li class=md-nav__item> <a href=../../../git/ title=GIT class=md-nav__link> GIT </a> </li> <li class=md-nav__item> <a href=../../../css/ title=CSS class=md-nav__link> CSS </a> </li> <li class=md-nav__item> <a href=../../../rest-api/ title="REST API" class=md-nav__link> REST API </a> </li> <li class=md-nav__item> <a href=../../../eslint/ title=ESLint class=md-nav__link> ESLint </a> </li> <li class=md-nav__item> <a href=../../ title=Javascript class=md-nav__link> Javascript </a> </li> <li class=md-nav__item> <a href=../../../nodejs/ title=Node.js class=md-nav__link> Node.js </a> </li> <li class=md-nav__item> <a href=../../../react/ title=React class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../../react-native/ title="React Native" class=md-nav__link> React Native </a> </li> <li class=md-nav__item> <a href=../../../redux-saga/ title="Redux Saga" class=md-nav__link> Redux Saga </a> </li> <li class=md-nav__item> <a href=../../../rxjs/ title=RxJS class=md-nav__link> RxJS </a> </li> <li class=md-nav__item> <a href=../../../mysql/ title=MySQL class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../../mongodb/ title=MongoDB class=md-nav__link> MongoDB </a> </li> <li class=md-nav__item> <a href=../../../firebase/ title=Firebase class=md-nav__link> Firebase </a> </li> <li class=md-nav__item> <a href=../../../web-security/ title="Web Security" class=md-nav__link> Web Security </a> </li> <li class=md-nav__item> <a href=../../../rust/ title=Rust class=md-nav__link> Rust </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#not-by-reference-but-by-share class=md-nav__link> Not by reference but by share </a> </li> <li class=md-nav__item> <a href=#shallow-copy class=md-nav__link> Shallow copy </a> </li> <li class=md-nav__item> <a href=#deep-copy class=md-nav__link> Deep copy </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#circular-object class=md-nav__link> Circular object </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#options-available-in-javascript-for-copying class=md-nav__link> Options available in Javascript for copying </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#objectassign class=md-nav__link> Object.assign() </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-nested-object-scenario class=md-nav__link> [1]. Nested object scenario </a> </li> <li class=md-nav__item> <a href=#2-a-getter-and-a-setter-will-be-copied-as-data class=md-nav__link> [2]. a getter and a setter, will be copied as data </a> </li> <li class=md-nav__item> <a href=#3-properties-on-the-prototype-chain-and-non-enumerable-properties-cannot-be-copied class=md-nav__link> [3]. Properties on the prototype chain and non-enumerable properties cannot be copied </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#jsonparsejsonstringify class=md-nav__link> JSON.parse(JSON.stringify()) </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-nested-object-scenario_1 class=md-nav__link> [1]. Nested object scenario </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spread-token class=md-nav__link> Spread token ... </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/abhaydgarg/Notebook/tree/master/src/javascript/js/reference-concept.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=reference-concept>Reference concept<a class=headerlink href=#reference-concept title="Permanent link">&para;</a></h1> <p><strong>Object and Array are reference data types</strong> and all other primitive types are value based data types. See example below:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>//### Primitive types</span>
<span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>//integer</span>
<span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=nx>x</span><span class=p>;</span>

<span class=nx>x</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>x</span><span class=p>);</span><span class=c1>//2</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>y</span><span class=p>);</span> <span class=c1>//1</span>
<span class=c1>//the value of y is unchanged because the copy of x value is assigned to y.</span>

<span class=c1>//### In case of object</span>
<span class=kd>var</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
   <span class=nx>x</span><span class=o>:</span> <span class=mi>1</span>
<span class=p>};</span>
<span class=kd>var</span> <span class=nx>obj1</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>;</span>
<span class=nx>obj</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>

<span class=c1>//any change to obj property x reflect to x property of obj1.</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>x</span><span class=p>);</span>   <span class=c1>//2</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj1</span><span class=p>.</span><span class=nx>x</span><span class=p>);</span> <span class=c1>//2</span>

<span class=c1>//### In case of Array</span>
<span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>];</span>

<span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>;</span>

<span class=c1>// add new element in b</span>
<span class=nx>b</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>

<span class=c1>// reflect change in a too</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=c1>// [1, 2, 3]</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span> <span class=c1>// [1, 2, 3]</span>
</pre></div> </td></tr></table> <p><strong>Situation where object reference mechanism can fool you.</strong></p> <p>Check out the example below:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>function</span> <span class=nx>test</span><span class=p>()</span> <span class=p>{</span>

  <span class=kd>var</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{};</span>
  <span class=kd>var</span> <span class=nx>collect</span> <span class=o>=</span> <span class=p>[];</span>

  <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>obj</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
    <span class=nx>obj</span><span class=p>.</span><span class=nx>y</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>;</span>
    <span class=nx>collect</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>collect</span><span class=p>);</span>
<span class=p>}</span>

<span class=nx>test</span><span class=p>();</span>

<span class=c1>//[{x:2, y:3}, {x:2, y:3}]</span>
</pre></div> </td></tr></table> <p>In above example, you supposed to get different key values <code>[{x:1, y:2}, {x:2, y:3}]</code>. But you get both objects with same key values. Because, when control runs the loop for first time the key values are set to <code>{x:1, y:2}</code> and push to the array. Second time when loop runs, the value of <code>obj.x</code> changed to 2. Now, the object that we have pushed to array before still refer/point to <code>obj</code>. So the value of <code>obj.x</code> is also changed in object pushed to an array previously. No matter how many times loop runs and how many objects are pushed to array called <code>collect</code> the value of keys would always be same for all objects in <code>collect</code> and which will be equal to the last object that is pushed.</p> <p><strong>To avoid the problem,</strong> you must declare the object inside loop that means creating the new reference for object every time.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>function</span> <span class=nx>test</span><span class=p>()</span> <span class=p>{</span>

  <span class=kd>var</span> <span class=nx>collect</span> <span class=o>=</span> <span class=p>[];</span>

  <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{};</span> <span class=c1>// new reference each time with same variable name</span>
    <span class=nx>obj</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
    <span class=nx>obj</span><span class=p>.</span><span class=nx>y</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>;</span>
    <span class=nx>collect</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>collect</span><span class=p>);</span>
<span class=p>}</span>

<span class=nx>test</span><span class=p>();</span>

<span class=c1>//[{x:1, y:2}, {x:2, y:3}]</span>

<span class=cm>/***** OR *****/</span>

<span class=c1>// just rewrite differently</span>

<span class=kd>function</span> <span class=nx>test</span><span class=p>()</span> <span class=p>{</span>

  <span class=kd>var</span> <span class=nx>obj</span><span class=p>;</span>
  <span class=kd>var</span> <span class=nx>collect</span> <span class=o>=</span> <span class=p>[];</span>

  <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>obj</span> <span class=o>=</span> <span class=p>{};</span> <span class=c1>// new reference each time with same variable name</span>
    <span class=nx>obj</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
    <span class=nx>obj</span><span class=p>.</span><span class=nx>y</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>;</span>
    <span class=nx>collect</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>collect</span><span class=p>);</span>
<span class=p>}</span>

<span class=nx>test</span><span class=p>();</span>

<span class=c1>//[{x:1, y:2}, {x:2, y:3}]</span>
</pre></div> </td></tr></table> <h2 id=not-by-reference-but-by-share>Not by reference but by share<a class=headerlink href=#not-by-reference-but-by-share title="Permanent link">&para;</a></h2> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>objOne</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>x</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
  <span class=nx>y</span><span class=o>:</span> <span class=mi>2</span>
<span class=p>};</span>

<span class=kd>var</span> <span class=nx>objTwo</span> <span class=o>=</span> <span class=nx>objOne</span><span class=p>;</span>

<span class=c1>// change the x vlaue to 2 by objTwo</span>
<span class=nx>objTwo</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>

<span class=c1>// Change the value of key x in objOne as well</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>objOne</span><span class=p>);</span> <span class=c1>// { x: 2, y: 2 }</span>

<span class=c1>// Now what if objTwo initialized with empty object</span>
<span class=nx>objTwo</span> <span class=o>=</span> <span class=p>{};</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>objOne</span><span class=p>);</span> <span class=c1>// { x: 2, y: 2 } but expected output = {}</span>

<span class=c1>// As per pass by reference mechanism. objOne is expected to</span>
<span class=c1>// log {}, because objTwo was re-initialized with {}.</span>
</pre></div> </td></tr></table> <blockquote> <p>Most techincal and accurate explanation is called "by share" topic in <a href=/javascript/ecma3/evaluation-strategy>Evaluation strategy</a></p> </blockquote> <p>When you assign one variable to another, it's not that both those variables are now linked by reference; you're misunderstanding what "pass by reference" here.</p> <p>A variable holding an object does not "directly" hold an object. What it holds is a reference to an object. When you assign that reference from one variable to another, you're making a <strong>copy</strong> of that reference. Now both variables hold a copy of reference to an object. Modifying the object through that reference changes it for both variables holding a reference to that object.</p> <p>When you assign a new value to one of the variables, you're just modifying the value that variable holds. The variable now ceases to hold a reference to the object, and instead holds something else. The other variable still holds its reference to the original object, the assignment didn't influence it at all.</p> <p><strong>Lets understand pass by reference step by step:</strong></p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=cm>/** Interpreter does:</span>
<span class=cm> * 1. Create object in memory with value {x:1, y:2} and create memory</span>
<span class=cm> *    reference (pointer) say &#39;ref-111&#39;, which points to the object.</span>
<span class=cm> *</span>
<span class=cm> * 2. The reference value is then assign to variable &#39;objOne&#39;. Hence,</span>
<span class=cm> *    &#39;objOne = ref-111&#39;. &#39;objOne&#39; does not hold actual value</span>
<span class=cm> *    {x:1, y:2} but reference value (ref-111).</span>
<span class=cm> */</span>

<span class=kd>var</span> <span class=nx>objOne</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>x</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
  <span class=nx>y</span><span class=o>:</span> <span class=mi>2</span>
<span class=p>};</span>

<span class=cm>/**</span>
<span class=cm> * Interpreter does:</span>
<span class=cm> * Create variable &#39;objTwo&#39; and assign/copy value of</span>
<span class=cm> * &#39;objOne&#39;, which is a reference value &#39;ref-111&#39;.</span>
<span class=cm> * Now, &#39;objOne = ref-111&#39; and &#39;objTwo = ref-111&#39;.</span>
<span class=cm> */</span>
<span class=kd>var</span> <span class=nx>objTwo</span> <span class=o>=</span> <span class=nx>objOne</span><span class=p>;</span>

<span class=cm>/**</span>
<span class=cm> * Interpreter does:</span>
<span class=cm> * 1. Create object in memory with value {} and create memory</span>
<span class=cm> *    reference (pointer) value say &#39;ref-222&#39; which point to the object.</span>
<span class=cm> *</span>
<span class=cm> * 2. The reference value is then assign/copy to variable &#39;objTwo&#39;.</span>
<span class=cm> *    Hence, &#39;objTwo = ref-222&#39;.</span>
<span class=cm> *    Now, &#39;objOne = ref-111&#39; and &#39;objTwo = ref-222&#39;.</span>
<span class=cm> */</span>
<span class=nx>objTwo</span> <span class=o>=</span> <span class=p>{};</span>

<span class=c1>//Therefore, &#39;console.log(objOne)&#39; is not expected to log {}.</span>
</pre></div> </td></tr></table> <h2 id=shallow-copy>Shallow copy<a class=headerlink href=#shallow-copy title="Permanent link">&para;</a></h2> <blockquote> <p>Shallow copy means copy only the reference.</p> </blockquote> <p><strong>Arrays and Object in Javascript performs the Shallow copy by default.</strong></p> <p>And change in copied object reflects in original object and vice versa.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>//### In case of object</span>
<span class=kd>var</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
   <span class=nx>x</span><span class=o>:</span> <span class=mi>1</span>
<span class=p>};</span>
<span class=kd>var</span> <span class=nx>obj1</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>;</span>
<span class=nx>obj</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>

<span class=c1>//any change to obj property x reflect to x property of obj1.</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>x</span><span class=p>);</span>   <span class=c1>//2</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj1</span><span class=p>.</span><span class=nx>x</span><span class=p>);</span> <span class=c1>//2</span>

<span class=c1>//### In case of Array</span>
<span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>];</span>

<span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>;</span>

<span class=c1>// add new element in b</span>
<span class=nx>b</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>

<span class=c1>// reflect change in a too</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=c1>// [1, 2, 3]</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span> <span class=c1>// [1, 2, 3]</span>
</pre></div> </td></tr></table> <h2 id=deep-copy>Deep copy<a class=headerlink href=#deep-copy title="Permanent link">&para;</a></h2> <p>Deep copy means copy the object properties recursively into the new object. In deep copy, Change in copied object does not reflect in original object and vice versa. All primitive data types in javascript performs deep copy by default. Boolean, Null, Undefined, Number, String etc… are Primitive data types in javascript.</p> <blockquote> <p><strong>There is no 100% pure native mechanism to perform a deep copy for object in JavaScript</strong> and one of the reason is that it’s quite complicated. For instance, there could be circular references (Circular objects) that are usually hard to deal with and there could be deep nested objects and doing deep copying could be a quite slow operation and memory consumption process.</p> </blockquote> <h3 id=circular-object>Circular object<a class=headerlink href=#circular-object title="Permanent link">&para;</a></h3> <p>Circular objects are objects that have properties referencing themselves. Let's use the methods of copying objects we've learnt so far to make copies of a circular object and see if it works.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>a</span><span class=o>:</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span>
  <span class=nx>b</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>c</span><span class=o>:</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span>
    <span class=nx>d</span><span class=o>:</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span>
  <span class=p>},</span>
<span class=p>}</span>

<span class=nx>obj</span><span class=p>.</span><span class=nx>c</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>;</span>
<span class=nx>obj</span><span class=p>.</span><span class=nx>e</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>a</span><span class=p>;</span>
<span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>c</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>c</span><span class=p>;</span>
<span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>d</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>;</span>
<span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>e</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>c</span><span class=p>;</span>

<span class=c1>//### Using JSON.parse(JSON.stringify())</span>
<span class=c1>// TypeError: Converting circular structure to JSON</span>
<span class=kd>let</span> <span class=nx>newObj</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>obj</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newObj</span><span class=p>);</span>

<span class=c1>//### Using Object.assign()</span>
<span class=c1>// works fine for shallow copying circular objects</span>
<span class=c1>// but wouldn&#39;t work for deep copying.</span>
<span class=kd>let</span> <span class=nx>newObj2</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>obj</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newObj2</span><span class=p>);</span>
</pre></div> </td></tr></table> <h2 id=options-available-in-javascript-for-copying>Options available in Javascript for copying<a class=headerlink href=#options-available-in-javascript-for-copying title="Permanent link">&para;</a></h2> <h3 id=objectassign>Object.assign()<a class=headerlink href=#objectassign title="Permanent link">&para;</a></h3> <p>It performs <strong>shallow copy</strong> and it merges own enumerable keys, giving priority right to left.</p> <h4 id=1-nested-object-scenario>[1]. Nested object scenario<a class=headerlink href=#1-nested-object-scenario title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>//### When we have object with only one level, means no nested object scenario</span>
<span class=c1>// in that case we can achieve deep copy</span>
<span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>a</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
  <span class=nx>b</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
<span class=p>};</span>
<span class=kd>let</span> <span class=nx>objCopy</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>obj</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>objCopy</span><span class=p>);</span> <span class=c1>// { a: 1, b: 2 }</span>
<span class=c1>// update property b</span>
<span class=nx>objCopy</span><span class=p>.</span><span class=nx>b</span> <span class=o>=</span> <span class=mi>89</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>objCopy</span><span class=p>);</span> <span class=c1>// { a: 1, b: 89 }</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span> <span class=c1>// { a: 1, b: 2 }</span>

<span class=c1>//### What happen when we have nested object scenario?</span>
<span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>a</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
  <span class=nx>b</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>c</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
  <span class=p>},</span>
<span class=p>}</span>
<span class=kd>let</span> <span class=nx>newObj</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>obj</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newObj</span><span class=p>);</span> <span class=c1>// { a: 1, b: { c: 2} }</span>

<span class=c1>// no change reflected</span>
<span class=nx>newObj</span><span class=p>.</span><span class=nx>a</span> <span class=o>=</span> <span class=mi>20</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span> <span class=c1>// { a: 10, b: { c: 2} }</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newObj</span><span class=p>);</span> <span class=c1>// { a: 20, b: { c: 2} }</span>

<span class=c1>// nested object - copied by reference</span>
<span class=c1>// change in newObj reflect change in obj</span>
<span class=nx>newObj</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>c</span> <span class=o>=</span> <span class=mi>30</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span> <span class=c1>// { a: 10, b: { c: 30} }</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newObj</span><span class=p>);</span> <span class=c1>// { a: 20, b: { c: 30} }</span>
</pre></div> </td></tr></table> <h4 id=2-a-getter-and-a-setter-will-be-copied-as-data>[2]. a getter and a setter, will be copied as data<a class=headerlink href=#2-a-getter-and-a-setter-will-be-copied-as-data title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>special</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>get</span> <span class=nx>next</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=o>++</span><span class=k>this</span><span class=p>.</span><span class=nx>counter</span><span class=p>;</span>
  <span class=p>},</span>
  <span class=nx>counter</span><span class=o>:</span> <span class=mi>0</span>
<span class=p>};</span>

<span class=c1>// what could possibly go wrong?</span>
<span class=kd>var</span> <span class=nx>notSpecial</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>special</span><span class=p>);</span>

<span class=nx>notSpecial</span><span class=p>.</span><span class=nx>counter</span><span class=p>;</span> <span class=c1>// 1 if `next` was copied before `counter`</span>
                    <span class=c1>// 0 if keys order is different: WATCH OUT!</span>
</pre></div> </td></tr></table> <blockquote> <p>Don’t use <code>Object.assign</code> for anything but simple shallow copies or merges with data you know for sure does NOT contain accessors.</p> </blockquote> <h4 id=3-properties-on-the-prototype-chain-and-non-enumerable-properties-cannot-be-copied>[3]. Properties on the prototype chain and non-enumerable properties cannot be copied<a class=headerlink href=#3-properties-on-the-prototype-chain-and-non-enumerable-properties-cannot-be-copied title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>let</span> <span class=nx>someObj</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>a</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
<span class=p>}</span>

<span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>someObj</span><span class=p>,</span> <span class=p>{</span>
  <span class=nx>b</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>value</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
  <span class=p>},</span>
  <span class=nx>c</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>value</span><span class=o>:</span> <span class=mi>3</span><span class=p>,</span>
    <span class=nx>enumerable</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
  <span class=p>},</span>
<span class=p>});</span>

<span class=kd>let</span> <span class=nx>objCopy</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>obj</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>objCopy</span><span class=p>);</span> <span class=c1>// { c: 3 }</span>

<span class=c1>// 1. someObj is on obj&#39;s prototype chain so it wouldn&#39;t be copied.</span>
<span class=c1>// 2. property b is a non-enumerable property.</span>
<span class=c1>// 3. property c has an enumerable property descriptor allowing it to be enumerable.</span>
<span class=c1>// That&#39;s why it was copied.</span>
</pre></div> </td></tr></table> <h3 id=jsonparsejsonstringify>JSON.parse(JSON.stringify())<a class=headerlink href=#jsonparsejsonstringify title="Permanent link">&para;</a></h3> <h4 id=1-nested-object-scenario_1>[1]. Nested object scenario<a class=headerlink href=#1-nested-object-scenario_1 title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>a</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
  <span class=nx>b</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>c</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
  <span class=p>},</span>
<span class=p>}</span>

<span class=kd>let</span> <span class=nx>newObj</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>obj</span><span class=p>));</span>

<span class=nx>obj</span><span class=p>.</span><span class=nx>b</span><span class=p>.</span><span class=nx>c</span> <span class=o>=</span> <span class=mi>20</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>);</span> <span class=c1>// { a: 1, b: { c: 20 } }</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>newObj</span><span class=p>);</span> <span class=c1>// { a: 1, b: { c: 2 } } (New Object Intact!)</span>
</pre></div> </td></tr></table> <blockquote> <p>Unfortunately, this method can't be used if you want to to copy object's methods too. See example below:</p> </blockquote> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;scotch.io&#39;</span><span class=p>,</span>
  <span class=nx>exec</span><span class=o>:</span> <span class=kd>function</span> <span class=nx>exec</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
  <span class=p>},</span>
<span class=p>}</span>

<span class=c1>//### using Object.assign() - Copy method too</span>
<span class=kd>let</span> <span class=nx>method1</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>({},</span> <span class=nx>obj</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>method1</span><span class=p>);</span>
<span class=cm>/* result</span>
<span class=cm>{</span>
<span class=cm>  exec: function exec() {</span>
<span class=cm>    return true;</span>
<span class=cm>  },</span>
<span class=cm>  name: &quot;scotch.io&quot;</span>
<span class=cm>}</span>
<span class=cm>*/</span>

<span class=c1>//### using JSON.parse(JSON.stringify()) - Exclude methods</span>
<span class=kd>let</span> <span class=nx>method2</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>obj</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>method2</span><span class=p>);</span>
<span class=cm>/* result</span>
<span class=cm>{</span>
<span class=cm>  name: &quot;scotch.io&quot;</span>
<span class=cm>}</span>
<span class=cm>*/</span>
</pre></div> </td></tr></table> <h3 id=spread-token>Spread token <code>...</code><a class=headerlink href=#spread-token title="Permanent link">&para;</a></h3> <blockquote> <p>This also support shallow copy only.</p> </blockquote> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Abhay Garg </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>