<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Notebook collections"><link href=https://abhaydgarg.github.io/Notebook/index.html/react/useEffect/ rel=canonical><meta name=author content="Abhay Garg"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>useEffect - Notebook</title><link rel=stylesheet href=../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#useeffect tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Notebook </span> <span class=md-header-nav__topic> useEffect </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-nav__button md-logo"> <i class=md-icon></i> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer-science/ title=CS class=md-nav__link> CS </a> </li> <li class=md-nav__item> <a href=../../parser/ title=Parser class=md-nav__link> Parser </a> </li> <li class=md-nav__item> <a href=../../data-structure-and-algorithms/ title="Data Structure and Algorithms" class=md-nav__link> Data Structure and Algorithms </a> </li> <li class=md-nav__item> <a href=../../oops/ title=OOPS class=md-nav__link> OOPS </a> </li> <li class=md-nav__item> <a href=../../design-patterns/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../regex/ title=Regex class=md-nav__link> Regex </a> </li> <li class=md-nav__item> <a href=../../git/ title=GIT class=md-nav__link> GIT </a> </li> <li class=md-nav__item> <a href=../../css/ title=CSS class=md-nav__link> CSS </a> </li> <li class=md-nav__item> <a href=../../rest-api/ title="REST API" class=md-nav__link> REST API </a> </li> <li class=md-nav__item> <a href=../../eslint/ title=ESLint class=md-nav__link> ESLint </a> </li> <li class=md-nav__item> <a href=../../javascript/ title=Javascript class=md-nav__link> Javascript </a> </li> <li class=md-nav__item> <a href=../../nodejs/ title=Node.js class=md-nav__link> Node.js </a> </li> <li class=md-nav__item> <a href=../ title=React class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../react-native/ title="React Native" class=md-nav__link> React Native </a> </li> <li class=md-nav__item> <a href=../../redux-saga/ title="Redux Saga" class=md-nav__link> Redux Saga </a> </li> <li class=md-nav__item> <a href=../../rxjs/ title=RxJS class=md-nav__link> RxJS </a> </li> <li class=md-nav__item> <a href=../../mysql/ title=MySQL class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../mongodb/ title=MongoDB class=md-nav__link> MongoDB </a> </li> <li class=md-nav__item> <a href=../../web-security/ title="Web Security" class=md-nav__link> Web Security </a> </li> <li class=md-nav__item> <a href=../../rust/ title=Rust class=md-nav__link> Rust </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#it-runs-both-after-the-first-render-and-after-every-subsequent-render class=md-nav__link> It runs both after the first render and after every subsequent render </a> </li> <li class=md-nav__item> <a href=#you-can-control-if-useeffect-should-run-on-subsequent-render class=md-nav__link> You can control if useEffect should run on subsequent render </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#missing-dependency class=md-nav__link> Missing dependency [] </a> </li> <li class=md-nav__item> <a href=#empty-dependency class=md-nav__link> Empty dependency [] </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trick-to-make-useeffect-behave-as-componentdidmount class=md-nav__link> Trick to make useEffect behave as componentDidMount </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#multiple-useeffect-to-have-a-separation-of-concern class=md-nav__link> Multiple useEffect to have a separation of concern </a> </li> <li class=md-nav__item> <a href=#cleanup-work-in-useeffect class=md-nav__link> Cleanup work in useEffect </a> </li> <li class=md-nav__item> <a href=#how-useeffect-works class=md-nav__link> How useEffect works </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lets-see-how-verbose-this-is-in-class-comp class=md-nav__link> Lets see how verbose this is in class comp </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/abhaydgarg/Notebook/tree/master/src/react/useEffect.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=useeffect>useEffect<a class=headerlink href=#useeffect title="Permanent link">&para;</a></h1> <blockquote> <p>Handles side-effects, that is why it is named useEffect. Effect short for side-effect.</p> </blockquote> <div class="admonition info"> <p class=admonition-title>Equivalent to</p> <p>useEffect is equivalent to <code>componentDidMount</code>, <code>componentDidUpdate</code> and <code>componentWillUnmount</code> combined.</p> </div> <h2 id=it-runs-both-after-the-first-render-and-after-every-subsequent-render>It runs both after the first render and after every subsequent render<a class=headerlink href=#it-runs-both-after-the-first-render-and-after-every-subsequent-render title="Permanent link">&para;</a></h2> <div class="admonition important"> <p class=admonition-title>Important</p> <p><strong>AFTER</strong> render - always</p> </div> <p>This is because it combination of <code>componentDidMount</code>, <code>componentDidUpdate</code> and <code>componentWillUnmount</code>. Instead of thinking in terms of “mounting” and “updating”, you might find it easier to think that <strong>effects happen <em>after render</em></strong>.</p> <p>For example, let say you have a prop called <code>title</code> which your component uses for setting the title of HTML doc.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>function</span> <span class=nx>Example</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>

  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=nb>document</span><span class=p>.</span><span class=nx>title</span> <span class=o>=</span> <span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
  <span class=p>});</span>

  <span class=k>return</span> <span class=p>(</span>
    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
      <span class=c1>// ...</span>
    <span class=o>&lt;</span><span class=err>/div&gt;</span>
  <span class=p>);</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>On <strong>first</strong> render comp set the HTML title. Now if it did not run when prop <code>title</code> get updated then the HTML doc title would also not get updated. Therefore, it runs after every render, so that changes can be applied when prop <code>title</code> get updated.</p> <h2 id=you-can-control-if-useeffect-should-run-on-subsequent-render>You can control if useEffect should run on subsequent render<a class=headerlink href=#you-can-control-if-useeffect-should-run-on-subsequent-render title="Permanent link">&para;</a></h2> <div class="admonition note"> <p class=admonition-title>Optimizing Performance by Skipping Effects</p> <p>useEffect always run once, which is after first render that you cannot stop.</p> <p>But you can skip useEffect on subsequent render.</p> </div> <h3 id=missing-dependency>Missing dependency <code>[]</code><a class=headerlink href=#missing-dependency title="Permanent link">&para;</a></h3> <p>This effect runs after every render.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>title</span> <span class=o>=</span> <span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
<span class=p>});</span>
</pre></div> </td></tr></table> <h3 id=empty-dependency>Empty dependency <code>[]</code><a class=headerlink href=#empty-dependency title="Permanent link">&para;</a></h3> <p>If you supply empty dependency, which is an array, then React compare the sameness of previous array and current array. If they differ then React run the <code>useEffect</code> otherwise it won't.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>title</span> <span class=o>=</span> <span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
<span class=p>},</span> <span class=p>[</span><span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>]);</span>
</pre></div> </td></tr></table> <div class="admonition note"> <p class=admonition-title>Note</p> <p>You can have multiple props and state variables in an array.</p> <p>For example, <code>[props.title, count, props.id]</code></p> </div> <p>If <code>props.title</code> previous value is equal to current value of <code>props.title</code> then React will not run the effect. If they are differ then React run the effect, so that HTML title can be updated.</p> <h4 id=trick-to-make-useeffect-behave-as-componentdidmount>Trick to make useEffect behave as componentDidMount<a class=headerlink href=#trick-to-make-useeffect-behave-as-componentdidmount title="Permanent link">&para;</a></h4> <blockquote> <p>You can make useEffect run after first render and then skip it for a good.</p> </blockquote> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>title</span> <span class=o>=</span> <span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
<span class=p>},</span> <span class=p>[]);</span>
</pre></div> </td></tr></table> <p><code>[]</code> empty array in a dependency, means that it will be always the same. So during ths sameness test React will see <code>[] === []</code> is <code>true</code>. And it skip the effect after every render.</p> <h2 id=multiple-useeffect-to-have-a-separation-of-concern>Multiple useEffect to have a separation of concern<a class=headerlink href=#multiple-useeffect-to-have-a-separation-of-concern title="Permanent link">&para;</a></h2> <p>You should use multiple useEffect in function comp in order to separate different logic one from another and place them in their own useEffect.</p> <blockquote> <p>In other words, useEffect should follow the design rule called "Single Responsibility".</p> </blockquote> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>function</span> <span class=nx>FriendStatusWithCounter</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Separate effect to handle the HTML</span>
  <span class=c1>// doc title only.</span>
  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=nb>document</span><span class=p>.</span><span class=nx>title</span> <span class=o>=</span> <span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
  <span class=p>});</span>

  <span class=c1>// Seaprate effect to subscribe and unsubscribe</span>
  <span class=c1>// firend status only.</span>
  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=kd>function</span> <span class=nx>handleStatusChange</span><span class=p>(</span><span class=nx>status</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>setIsOnline</span><span class=p>(</span><span class=nx>status</span><span class=p>.</span><span class=nx>isOnline</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>subscribeToFriendStatus</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>handleStatusChange</span><span class=p>);</span>
    <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>unsubscribeFromFriendStatus</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>handleStatusChange</span><span class=p>);</span>
    <span class=p>};</span>
  <span class=p>});</span>
  <span class=c1>// ...</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <h2 id=cleanup-work-in-useeffect>Cleanup work in useEffect<a class=headerlink href=#cleanup-work-in-useeffect title="Permanent link">&para;</a></h2> <p>There are situation when you need to unsubscribe to event, or something before component umount in order to free up the memory. This can be done in useEffect by supplying the <code>return</code> statement.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=c1>// Subscribe.</span>
  <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>subscribeToFriendStatus</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>handleStatusChange</span><span class=p>);</span>

  <span class=c1>// Unsubscribe.</span>
  <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>unsubscribeFromFriendStatus</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>handleStatusChange</span><span class=p>);</span>
  <span class=p>};</span>
<span class=p>});</span>
</pre></div> </td></tr></table> <p>The benefit of this is that we do not have to write the subscribe login in <code>componentDidMount</code> and unsubscribe login in <code>componentWillUnMount</code> methods. At one place we have the same logic handling.</p> <h2 id=how-useeffect-works>How useEffect works<a class=headerlink href=#how-useeffect-works title="Permanent link">&para;</a></h2> <p>After every render - React remove the previous effect and add the current effect. While removing the previous effect React also run the cleanup work if any.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>subscribeToFriendStatus</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>handleStatusChange</span><span class=p>);</span>

  <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>unsubscribeFromFriendStatus</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>handleStatusChange</span><span class=p>);</span>
  <span class=p>};</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=o>//</span> <span class=nv>Mount</span> <span class=nv>with</span> { <span class=nv>friend</span>: { <span class=nv>id</span>: <span class=mi>100</span> } } <span class=nv>props</span>
<span class=nv>ChatAPI</span>.<span class=nv>subscribeToFriendStatus</span><span class=ss>(</span><span class=mi>100</span>, <span class=nv>handleStatusChange</span><span class=ss>)</span><span class=c1>;     // Run first effect</span>

<span class=o>//</span> <span class=nv>Update</span> <span class=nv>with</span> { <span class=nv>friend</span>: { <span class=nv>id</span>: <span class=mi>200</span> } } <span class=nv>props</span>
<span class=nv>ChatAPI</span>.<span class=nv>unsubscribeFromFriendStatus</span><span class=ss>(</span><span class=mi>100</span>, <span class=nv>handleStatusChange</span><span class=ss>)</span><span class=c1>; // Clean up previous effect</span>
<span class=nv>ChatAPI</span>.<span class=nv>subscribeToFriendStatus</span><span class=ss>(</span><span class=mi>200</span>, <span class=nv>handleStatusChange</span><span class=ss>)</span><span class=c1>;     // Run next effect</span>

<span class=o>//</span> <span class=nv>Update</span> <span class=nv>with</span> { <span class=nv>friend</span>: { <span class=nv>id</span>: <span class=mi>300</span> } } <span class=nv>props</span>
<span class=nv>ChatAPI</span>.<span class=nv>unsubscribeFromFriendStatus</span><span class=ss>(</span><span class=mi>200</span>, <span class=nv>handleStatusChange</span><span class=ss>)</span><span class=c1>; // Clean up previous effect</span>
<span class=nv>ChatAPI</span>.<span class=nv>subscribeToFriendStatus</span><span class=ss>(</span><span class=mi>300</span>, <span class=nv>handleStatusChange</span><span class=ss>)</span><span class=c1>;     // Run next effect</span>

<span class=o>//</span> <span class=nv>Unmount</span>
<span class=nv>ChatAPI</span>.<span class=nv>unsubscribeFromFriendStatus</span><span class=ss>(</span><span class=mi>300</span>, <span class=nv>handleStatusChange</span><span class=ss>)</span><span class=c1>; // Clean up last effect</span>
</pre></div> </td></tr></table> <h3 id=lets-see-how-verbose-this-is-in-class-comp>Lets see how verbose this is in class comp<a class=headerlink href=#lets-see-how-verbose-this-is-in-class-comp title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>componentDidMount</span><span class=p>()</span> <span class=p>{</span>
  <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>subscribeToFriendStatus</span><span class=p>(</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>handleStatusChange</span>
  <span class=p>);</span>
<span class=p>}</span>

<span class=nx>componentDidUpdate</span><span class=p>(</span><span class=nx>prevProps</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Unsubscribe from the previous friend.id</span>
  <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>unsubscribeFromFriendStatus</span><span class=p>(</span>
    <span class=nx>prevProps</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>handleStatusChange</span>
  <span class=p>);</span>
  <span class=c1>// Subscribe to the next friend.id</span>
  <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>subscribeToFriendStatus</span><span class=p>(</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>handleStatusChange</span>
  <span class=p>);</span>
<span class=p>}</span>

<span class=nx>componentWillUnmount</span><span class=p>()</span> <span class=p>{</span>
  <span class=nx>ChatAPI</span><span class=p>.</span><span class=nx>unsubscribeFromFriendStatus</span><span class=p>(</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>friend</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>handleStatusChange</span>
  <span class=p>);</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Forgetting to handle <code>componentDidUpdate</code> properly is a common source of bugs in React applications.</p> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Abhay Garg </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>