<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Notebook collections"><link href=https://abhaydgarg.github.io/Notebook/index.html/nodejs/npm/ rel=canonical><meta name=author content="Abhay Garg"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>NPM - Notebook</title><link rel=stylesheet href=../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#npm tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Notebook </span> <span class=md-header-nav__topic> NPM </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-nav__button md-logo"> <i class=md-icon></i> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer-science/ title=CS class=md-nav__link> CS </a> </li> <li class=md-nav__item> <a href=../../parser/ title=Parser class=md-nav__link> Parser </a> </li> <li class=md-nav__item> <a href=../../data-structure-and-algorithms/ title="Data Structure and Algorithms" class=md-nav__link> Data Structure and Algorithms </a> </li> <li class=md-nav__item> <a href=../../oops/ title=OOPS class=md-nav__link> OOPS </a> </li> <li class=md-nav__item> <a href=../../design-patterns/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../regex/ title=Regex class=md-nav__link> Regex </a> </li> <li class=md-nav__item> <a href=../../git/ title=GIT class=md-nav__link> GIT </a> </li> <li class=md-nav__item> <a href=../../css/ title=CSS class=md-nav__link> CSS </a> </li> <li class=md-nav__item> <a href=../../rest-api/ title="REST API" class=md-nav__link> REST API </a> </li> <li class=md-nav__item> <a href=../../eslint/ title=ESLint class=md-nav__link> ESLint </a> </li> <li class=md-nav__item> <a href=../../javascript/ title=Javascript class=md-nav__link> Javascript </a> </li> <li class=md-nav__item> <a href=../ title=Node.js class=md-nav__link> Node.js </a> </li> <li class=md-nav__item> <a href=../../react/ title=React class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../react-native/ title="React Native" class=md-nav__link> React Native </a> </li> <li class=md-nav__item> <a href=../../redux-saga/ title="Redux Saga" class=md-nav__link> Redux Saga </a> </li> <li class=md-nav__item> <a href=../../rxjs/ title=RxJS class=md-nav__link> RxJS </a> </li> <li class=md-nav__item> <a href=../../mysql/ title=MySQL class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../mongodb/ title=MongoDB class=md-nav__link> MongoDB </a> </li> <li class=md-nav__item> <a href=../../firebase/ title=Firebase class=md-nav__link> Firebase </a> </li> <li class=md-nav__item> <a href=../../web-security/ title="Web Security" class=md-nav__link> Web Security </a> </li> <li class=md-nav__item> <a href=../../rust/ title=Rust class=md-nav__link> Rust </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#semver-semantic-versioning class=md-nav__link> semver (semantic versioning) </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-release-tags class=md-nav__link> Pre-release tags </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#version-ranges class=md-nav__link> Version ranges </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#simple-ranges class=md-nav__link> Simple ranges </a> </li> <li class=md-nav__item> <a href=#hyphen-ranges class=md-nav__link> Hyphen ranges </a> </li> <li class=md-nav__item> <a href=#x-ranges class=md-nav__link> X ranges </a> </li> <li class=md-nav__item> <a href=#tilde-ranges class=md-nav__link> Tilde ranges </a> </li> <li class=md-nav__item> <a href=#caret-ranges class=md-nav__link> Caret ranges </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#npm-install class=md-nav__link> npm install </a> </li> <li class=md-nav__item> <a href=#change-npm-default class=md-nav__link> Change npm default ^ </a> </li> <li class=md-nav__item> <a href=#npmrc class=md-nav__link> npmrc </a> </li> <li class=md-nav__item> <a href=#packagejson-worthy-to-know-some-properties class=md-nav__link> package.json - worthy to know some properties </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#another-ways-to-add-package-in-packagejson class=md-nav__link> Another ways to add package in package.json </a> </li> <li class=md-nav__item> <a href=#three-ways-to-add-dependencies class=md-nav__link> Three ways to add dependencies </a> </li> <li class=md-nav__item> <a href=#engines class=md-nav__link> engines </a> </li> <li class=md-nav__item> <a href=#private class=md-nav__link> private </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#folder-structures-used-by-npm class=md-nav__link> Folder Structures Used by npm </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#executables-bin class=md-nav__link> Executables (bin) </a> </li> <li class=md-nav__item> <a href=#cache class=md-nav__link> cache </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#package-lockjson class=md-nav__link> package-lock.json </a> </li> <li class=md-nav__item> <a href=#npm-ci class=md-nav__link> npm ci </a> </li> <li class=md-nav__item> <a href=#npm-shrinkwrapjson class=md-nav__link> npm-shrinkwrap.json </a> </li> <li class=md-nav__item> <a href=#npmx class=md-nav__link> npmx </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#to-avoid-all-this-hassles-npx-is-introduced class=md-nav__link> To avoid all this hassles, npx is introduced </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-package-is-already-installed class=md-nav__link> [1] Package is already installed </a> </li> <li class=md-nav__item> <a href=#2-package-is-not-already-installed class=md-nav__link> [2] Package is not already installed </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/abhaydgarg/Notebook/tree/master/src/nodejs/npm.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=npm>NPM<a class=headerlink href=#npm title="Permanent link">&para;</a></h1> <h2 id=semver-semantic-versioning>semver (semantic versioning)<a class=headerlink href=#semver-semantic-versioning title="Permanent link">&para;</a></h2> <p>It is intuitive way to know what have been introduced in new version by comparing with old version number.</p> <blockquote> <p>Major.Minor.Patch</p> </blockquote> <ul> <li>Major: Breaks the API and not backward compatible.</li> <li>Minor: Add new features but does not break the API.</li> <li>Patches: Bug fixes.</li> </ul> <h3 id=pre-release-tags>Pre-release tags<a class=headerlink href=#pre-release-tags title="Permanent link">&para;</a></h3> <ul> <li>Major.Minor.Patch-alpha.number: <code>1.2.3-alpha.3</code>.</li> <li>Major.Minor.Patch-beta.number: <code>1.2.3-beta.3</code></li> </ul> <h2 id=version-ranges>Version ranges<a class=headerlink href=#version-ranges title="Permanent link">&para;</a></h2> <h3 id=simple-ranges>Simple ranges<a class=headerlink href=#simple-ranges title="Permanent link">&para;</a></h3> <ul> <li><code>&lt;</code> Less than</li> <li><code>&lt;=</code> Less than or equal to</li> <li><code>&gt;</code> Greater than</li> <li><code>&gt;=</code> Greater than or equal to</li> <li><code>=</code> Equal. If no operator is specified, then equality is assumed.</li> </ul> <p><code>&gt;=1.2.7 would match the versions 1.2.7, 1.2.8, 2.5.3, and 1.3.9, but not the versions 1.2.6 or 1.1.0.</code></p> <p>Use of <code>||</code>.</p> <p><code>1.4.0 || &gt;= 2.4.0</code>: Matches the version <code>1.4.0</code>, but also every version equal or greater than <code>2.4.0</code>. Doesn’t match <code>1.3.5</code> or <code>2.3.9</code>.</p> <h3 id=hyphen-ranges>Hyphen ranges<a class=headerlink href=#hyphen-ranges title="Permanent link">&para;</a></h3> <p><code>1.4.0–1.5.2</code>: Match every version from <code>1.4.0</code> to <code>1.5.2</code>.</p> <h3 id=x-ranges>X ranges<a class=headerlink href=#x-ranges title="Permanent link">&para;</a></h3> <p>Any of X, x, or * may be used to “stand in” for one of the numeric values in the [major, minor, patch] tuple.</p> <ul> <li><code>*</code> || <code>x</code>: Any version.</li> <li><code>1.4.x</code>: Match <code>1.4.0</code>, <code>1.4.1</code>, <code>1.4.2</code>, and so on.</li> <li><code>1.x.x</code>: Match every version that begins with a <code>1</code>. You can also write this as <code>1.x</code>.</li> </ul> <h3 id=tilde-ranges>Tilde ranges<a class=headerlink href=#tilde-ranges title="Permanent link">&para;</a></h3> <blockquote> <p>Fixes major and minor numbers. Accept patch changes only.</p> </blockquote> <p><code>~1.2.3</code> will match all <code>1.2.x</code> versions but will miss <code>1.3.0</code>.</p> <h3 id=caret-ranges>Caret ranges<a class=headerlink href=#caret-ranges title="Permanent link">&para;</a></h3> <blockquote> <p>Fixes the major number only. Accept minor as well as patch changes.</p> </blockquote> <p><code>^1.2.3</code> will match any <code>1.x.x</code> release including <code>1.3.0</code>, but will hold off on <code>2.0.0</code>.</p> <h2 id=npm-install>npm install<a class=headerlink href=#npm-install title="Permanent link">&para;</a></h2> <p><code>npm install &lt;package_name&gt;@&lt;version_number&gt;</code></p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class=code><div class=codehilite><pre><span></span>npm install lodash@latest // For the last stable version
npm install lodash@next // For the most recent release

npm install lodash@4.17.14 // For the exact release
// OR
npm install lodash@<span class=o>=</span><span class=m>4</span>.17.14

// Ranges can also be used.
npm install lodash@<span class=s2>&quot;&lt;=3&quot;</span> // Use of quotes
npm install sax@<span class=s2>&quot;&gt;=0.1.0 &lt;0.2.0&quot;</span>
</pre></div> </td></tr></table> <ul> <li>By default save the package to <code>dependencies</code> property of <code>package.json</code>. No need to mention <code>--save || -S</code> flag.</li> <li>Use <code>-D || --save-dev</code> to list the package to <code>devDependencies</code>.</li> <li>Use <code>-E || --save-exact</code> to save the package without <code>^</code> in <code>package.json</code>.</li> </ul> <blockquote> <p>By default npm use caret <code>^</code> in front of package version when save in <code>package.json</code>. If you do not want <code>^</code> then use <code>-E || --save-exact</code> flag.</p> </blockquote> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span>// Save as: <span class=s2>&quot;loadash&quot;</span>: <span class=s2>&quot;^4.17.14&quot;</span>
npm install lodash

// Save as: <span class=s2>&quot;loadash&quot;</span>: <span class=s2>&quot;4.17.14&quot;</span>
npm install -E lodash
</pre></div> </td></tr></table> <h2 id=change-npm-default>Change npm default <code>^</code><a class=headerlink href=#change-npm-default title="Permanent link">&para;</a></h2> <p>When you install package, npm by default save it in the <code>package.json</code> file with caret <code>^</code> in front of version. The default behavior can be altered.</p> <p><code>npm config set save-prefix '~'</code></p> <p><code>npm config set save-exact true</code></p> <h2 id=npmrc>npmrc<a class=headerlink href=#npmrc title="Permanent link">&para;</a></h2> <blockquote> <p>Config file.</p> </blockquote> <p>npm gets its config settings from the command line, environment variables, and npmrc files.</p> <ul> <li>per-project config file <code>/path/to/my/project/.npmrc</code></li> <li>per-user config file <code>~/.npmrc</code></li> <li>global config file <code>$PREFIX/etc/npmrc</code></li> <li>npm builtin config file <code>/path/to/npm/npmrc</code></li> </ul> <h2 id=packagejson-worthy-to-know-some-properties>package.json - worthy to know some properties<a class=headerlink href=#packagejson-worthy-to-know-some-properties title="Permanent link">&para;</a></h2> <h3 id=another-ways-to-add-package-in-packagejson>Another ways to add package in package.json<a class=headerlink href=#another-ways-to-add-package-in-packagejson title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// URL - tarball</span>
<span class=s2>&quot;http://asdf.com/asdf.tar.gz&quot;</span>

<span class=c1>// URL - git</span>
<span class=s2>&quot;git+ssh://git@github.com:npm/cli.git#v1.0.27&quot;</span>
<span class=s2>&quot;git+ssh://git@github.com:npm/cli#semver:^5.0&quot;</span>
<span class=s2>&quot;git+https://isaacs@github.com/npm/cli.git&quot;</span>
<span class=s2>&quot;git://github.com/npm/cli.git#v1.0.27&quot;</span>

<span class=c1>// Local path</span>
<span class=c1>// Run</span>
<span class=nx>npm</span> <span class=nx>install</span> <span class=o>&lt;</span><span class=nx>localpath</span><span class=o>&gt;</span>
<span class=c1>// This save the package with relative path</span>
<span class=s2>&quot;file:../foo/bar&quot;</span>
</pre></div> </td></tr></table> <h3 id=three-ways-to-add-dependencies>Three ways to add dependencies<a class=headerlink href=#three-ways-to-add-dependencies title="Permanent link">&para;</a></h3> <ul> <li>dependencies</li> <li>devDependencies</li> <li>peerDependencies</li> </ul> <h3 id=engines>engines<a class=headerlink href=#engines title="Permanent link">&para;</a></h3> <p>Specify the version of <strong>node</strong> that your stuff works on. If you don’t specify the version (or if you specify “*” as the version), then any version of node will do.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>{</span> <span class=s2>&quot;engines&quot;</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&quot;node&quot;</span> <span class=o>:</span> <span class=s2>&quot;10&quot;</span> <span class=p>}</span> <span class=p>}</span>
</pre></div> </td></tr></table> <h3 id=private>private<a class=headerlink href=#private title="Permanent link">&para;</a></h3> <p>If you set <code>"private": true</code> in your package.json, then npm will refuse to publish it. This is a way to prevent accidental publication of private repositories.</p> <h2 id=folder-structures-used-by-npm>Folder Structures Used by npm<a class=headerlink href=#folder-structures-used-by-npm title="Permanent link">&para;</a></h2> <ul> <li>Local install (default): puts stuff in <code>./node_modules</code> of the current package root.</li> <li>Global install (with <code>-g</code>): puts stuff in /usr/local or wherever node is installed.</li> <li>Install it <strong>locally</strong> if you’re going to <code>require()</code> it.</li> <li>Install it <strong>globally</strong> if you’re going to run it on the command line.</li> <li>If you need both, then install it in both places, or use <code>npm link</code>.</li> </ul> <h3 id=executables-bin>Executables (bin)<a class=headerlink href=#executables-bin title="Permanent link">&para;</a></h3> <p>When in global mode, executables are linked into <code>{prefix}/bin</code> on Unix, or directly into <code>{prefix}</code> on Windows.</p> <p>When in local mode, executables are linked into <code>./node_modules/.bin</code> so that they can be made available to scripts run through npm.</p> <h3 id=cache>cache<a class=headerlink href=#cache title="Permanent link">&para;</a></h3> <p>Cache files are stored in <code>~/.npm</code> on Posix, or <code>%AppData%/npm-cache</code> on Windows.</p> <h2 id=package-lockjson>package-lock.json<a class=headerlink href=#package-lockjson title="Permanent link">&para;</a></h2> <p>Let’s say we create a new project that is going to use express. After running <code>npm init</code>, we install express: <code>npm install express</code>. At the time of writing, the latest express version is <code>4.15.4</code>. So “express”: <code>^4.15.4</code> is added as a dependency within my package.json and that exact version is installed on my machine. Now maybe tomorrow, the maintainers of express release a bug fix, and so the latest version becomes <code>4.15.5</code>. Then if someone were to want to contribute to my project, they would clone it, and run <code>npm install.</code> Since <code>4.15.5</code> is a higher version with the same major version, that is installed for them. We both have express, but we have two different versions. Theoretically, they should still be compatible, but maybe that bugfix affected functionality that we are using, and our application would produce different results when run with express version <code>4.15.4</code> compared to <code>4.15.5</code>.</p> <p>package-lock.json will simply avoid this general behavior of installing updated minor version so when someone clones your repo and run npm install in their machine. NPM will look into package-lock.json and install exact versions of the package as the owner has installed.</p> <div class="admonition info"> <p class=admonition-title>The story about package.json vs package-lock.json is tricky</p> <p><code>npm install</code> verify that the package.json and package-lock.json <em>correspond to each other</em>. That is, if the semver versions described in package.json fit with the locked versions in package-lock.json, <code>npm install</code> will use the package-lock.json.</p> <p>Now, if you <em>change</em> <code>package.json</code> such that the versions in <code>package-lock.json</code> are no longer valid, your <code>npm install</code> will be treated as if you'd done <code>npm install some-pkg@x.y.z</code>, where <code>x.y.z</code> is the new version in the package.json. In this case of conflict, the version in package.json file is installed.</p> <p>The conflict happens when someone directly edit the package.json file and does not run <code>npm install</code> and ship the package.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Always commit package-lock.json file</p> </div> <h2 id=npm-ci>npm ci<a class=headerlink href=#npm-ci title="Permanent link">&para;</a></h2> <p>As mentioned above in package.json, when version conflict is occured between package.json and package-lock.json then version in pakcage.json is installed.</p> <p>But what if you want to notify the user about the conflict?</p> <ul> <li><code>npm ci</code> can only install entire projects at a time: individual dependencies cannot be added with this command.</li> <li>If dependencies in the package-lock.json do not match those in package.json, <code>npm ci</code> will exit with an error, instead of updating the package lock.</li> <li>If a node_modules is already present, it will be automatically removed before <code>npm ci</code> begins its install.</li> <li>It will never write to package.json or any of the package-locks: installs are essentially frozen.</li> </ul> <h2 id=npm-shrinkwrapjson>npm-shrinkwrap.json<a class=headerlink href=#npm-shrinkwrapjson title="Permanent link">&para;</a></h2> <p>It lets you lock down the version numbers all the packages and their descendant packages in your <code>node_modules</code> directory.</p> <p>The issue arises due to the way npm install works. See npm install save the entry in <code>package.json</code> using caret <code>^</code> which means if you have entry say <code>"lodash": "^1.2.9"</code> in <code>package.json</code> and you hand the code over to some person and when he run <code>npm install</code>, there is new version lodash version available <code>1.3.0</code>, so in this case npm does not install <code>1.2.9</code> but <code>1.3.0</code>. We can control this by setting default config by running <code>npm config set save-exact true</code> which save the entry without <code>^</code>. However that only solves the problem for the direct dependents of your package. It does not give you control over the installed versions of the deeply nested packages that are the dependencies of your dependencies and beyond.</p> <p>This can be crucial to you in a production environment because you need to ensure that each production re-deployment always always installs the same versions of the package as the other deployments.</p> <p>This is where <code>npm shrinkwrap</code> comes into play. When you run <code>npm shrinkwrap</code> in a project after running <code>npm install</code>, it creates a file called <code>npm-shrinkwrap.json</code> which lists the exact package versions of all the installed packages in the entire hierarchy.</p> <p>Also note that by default npm shrinkwrap does not include your devDependencies unless you pass run <code>npm shrinkwrap --dev</code>.</p> <h2 id=npmx>npmx<a class=headerlink href=#npmx title="Permanent link">&para;</a></h2> <p>Let's know something about <code>npm</code> first.</p> <p>One might install a package locally on a certain project:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>npm install some-package
</pre></div> </td></tr></table> <p>Now let's say you want NodeJS to execute that package from the command line:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>$ some-package
</pre></div> </td></tr></table> <p>The above will fail. Only globally installed packages can be executed by typing their name only.</p> <p>To fix this, and have it run, you must type the local path:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>$ ./node_modules/.bin/some-package
</pre></div> </td></tr></table> <p>You can technically run a locally installed package by editing your packages.json file and adding that package in the <code>scripts</code> section:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6
7</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>{</span>
  <span class=s2>&quot;name&quot;</span><span class=o>:</span> <span class=s2>&quot;whatever&quot;</span><span class=p>,</span>
  <span class=s2>&quot;version&quot;</span><span class=o>:</span> <span class=s2>&quot;1.0.0&quot;</span><span class=p>,</span>
  <span class=s2>&quot;scripts&quot;</span><span class=o>:</span> <span class=p>{</span>
    <span class=s2>&quot;some-package&quot;</span><span class=o>:</span> <span class=s2>&quot;some-package&quot;</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Then run the script using <code>npm run-script</code> (or <code>npm run</code>):</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>npm run some-package
</pre></div> </td></tr></table> <h3 id=to-avoid-all-this-hassles-npx-is-introduced>To avoid all this hassles, <code>npx</code> is introduced<a class=headerlink href=#to-avoid-all-this-hassles-npx-is-introduced title="Permanent link">&para;</a></h3> <h4 id=1-package-is-already-installed>[1] Package is already installed<a class=headerlink href=#1-package-is-already-installed title="Permanent link">&para;</a></h4> <p>Package is already installed and you want to run package execuatable inside <code>/node_modules/.bin/</code>.</p> <p><code>npx</code> will check whether <code>&lt;command&gt;</code> exists in <code>$PATH</code>, or in the local project binaries, and execute it. So, for the above example, if you wish to execute the locally-installed package <code>some-package</code> all you need to do is type:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>npx some-package
</pre></div> </td></tr></table> <h4 id=2-package-is-not-already-installed>[2] Package is not already installed<a class=headerlink href=#2-package-is-not-already-installed title="Permanent link">&para;</a></h4> <p>Another major advantage of npx is the ability to execute a package which wasn't previously installed:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>$ npx create-react-app my-app
</pre></div> </td></tr></table> <p>In example above, <code>create-react-app</code> package is downloaded temporarily, create the react app and when finished the package is removed. <code>create-react-app</code> is an npm package that is expected to be run only once in a project's lifecycle. Hence, it is preferred to use npx to install and run it in a single step.</p> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Abhay Garg </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>