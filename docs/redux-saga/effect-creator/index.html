<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Notebook collections"><link href=https://abhaydgarg.github.io/Notebook/index.html/redux-saga/effect-creator/ rel=canonical><meta name=author content="Abhay Garg"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>Effect - Notebook</title><link rel=stylesheet href=../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=fallback"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#effect tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Notebook </span> <span class=md-header-nav__topic> Effect </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://abhaydgarg.github.io/Notebook/index.html title=Notebook class="md-nav__button md-logo"> <i class=md-icon></i> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/abhaydgarg/Notebook/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../computer-science/ title=CS class=md-nav__link> CS </a> </li> <li class=md-nav__item> <a href=../../parser/ title=Parser class=md-nav__link> Parser </a> </li> <li class=md-nav__item> <a href=../../data-structure-and-algorithms/ title="Data Structure and Algorithms" class=md-nav__link> Data Structure and Algorithms </a> </li> <li class=md-nav__item> <a href=../../oops/ title=OOPS class=md-nav__link> OOPS </a> </li> <li class=md-nav__item> <a href=../../design-patterns/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../regex/ title=Regex class=md-nav__link> Regex </a> </li> <li class=md-nav__item> <a href=../../git/ title=GIT class=md-nav__link> GIT </a> </li> <li class=md-nav__item> <a href=../../css/ title=CSS class=md-nav__link> CSS </a> </li> <li class=md-nav__item> <a href=../../rest-api/ title="REST API" class=md-nav__link> REST API </a> </li> <li class=md-nav__item> <a href=../../eslint/ title=ESLint class=md-nav__link> ESLint </a> </li> <li class=md-nav__item> <a href=../../javascript/ title=Javascript class=md-nav__link> Javascript </a> </li> <li class=md-nav__item> <a href=../../nodejs/ title=Node.js class=md-nav__link> Node.js </a> </li> <li class=md-nav__item> <a href=../../react/ title=React class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../react-native/ title="React Native" class=md-nav__link> React Native </a> </li> <li class=md-nav__item> <a href=../ title="Redux Saga" class=md-nav__link> Redux Saga </a> </li> <li class=md-nav__item> <a href=../../rxjs/ title=RxJS class=md-nav__link> RxJS </a> </li> <li class=md-nav__item> <a href=../../mysql/ title=MySQL class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../mongodb/ title=MongoDB class=md-nav__link> MongoDB </a> </li> <li class=md-nav__item> <a href=../../web-security/ title="Web Security" class=md-nav__link> Web Security </a> </li> <li class=md-nav__item> <a href=../../rust/ title=Rust class=md-nav__link> Rust </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#how-returning-the-simple-object-which-describe-the-effect-help-in-testing class=md-nav__link> How returning the simple object which describe the effect, help in testing </a> </li> <li class=md-nav__item> <a href=#effect-creators class=md-nav__link> Effect creators </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-blocking-effect-and-non-blocking-effect class=md-nav__link> What is blocking effect and non blocking effect </a> </li> <li class=md-nav__item> <a href=#takepattern class=md-nav__link> take(pattern) </a> </li> <li class=md-nav__item> <a href=#forkfn-args class=md-nav__link> fork(fn, ...args) </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#note class=md-nav__link> Note </a> </li> <li class=md-nav__item> <a href=#call-vs-fork class=md-nav__link> call vs. fork </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spawnfn-args class=md-nav__link> spawn(fn, ...args) </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fork-vs-spawn class=md-nav__link> fork vs. spawn </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/abhaydgarg/Notebook/tree/master/src/redux-saga/effect-creator.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=effect>Effect<a class=headerlink href=#effect title="Permanent link">&para;</a></h1> <p>Effects in <code>redux-saga</code> are represented by an simple object, which contain the information about the effect. So when you create or call the effect's function say:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=nx>products</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>call</span><span class=p>(</span><span class=nx>Api</span><span class=p>.</span><span class=nx>fetch</span><span class=p>,</span> <span class=s1>&#39;/products&#39;</span><span class=p>);</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>products</span><span class=p>);</span>

<span class=c1>// `products` gives you the effect&#39;s description</span>
<span class=c1>// which is then run by middleware.</span>
<span class=c1>// {</span>
<span class=c1>//   CALL: {</span>
<span class=c1>//     fn: Api.fetch,</span>
<span class=c1>//     args: [&#39;./products&#39;]</span>
<span class=c1>//   }</span>
<span class=c1>// }</span>
</pre></div> </td></tr></table> <h2 id=how-returning-the-simple-object-which-describe-the-effect-help-in-testing>How returning the simple object which describe the effect, help in testing<a class=headerlink href=#how-returning-the-simple-object-which-describe-the-effect-help-in-testing title="Permanent link">&para;</a></h2> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// Generator function (Worker saga) to fetch products</span>
<span class=c1>// using effect creator function `call`.</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>call</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;redux-saga/effects&#39;</span>

<span class=kd>function</span><span class=o>*</span> <span class=nx>fetchProducts</span><span class=p>()</span> <span class=p>{</span>
  <span class=c1>// the `call` creates a description of the effect.</span>
  <span class=kr>const</span> <span class=nx>products</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>call</span><span class=p>(</span><span class=nx>Api</span><span class=p>.</span><span class=nx>fetch</span><span class=p>,</span> <span class=s1>&#39;/products&#39;</span><span class=p>)</span>
  <span class=c1>// ...</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// Testing `fetchProducts` generator function</span>
<span class=c1>// that fetches the products from API.</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>call</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;redux-saga/effects&#39;</span><span class=p>;</span>
<span class=kr>import</span> <span class=nx>Api</span> <span class=nx>from</span> <span class=s1>&#39;...&#39;</span><span class=p>;</span>

<span class=kr>const</span> <span class=nx>iterator</span> <span class=o>=</span> <span class=nx>fetchProducts</span><span class=p>();</span>

<span class=c1>// expects a call instruction</span>
<span class=nx>assert</span><span class=p>.</span><span class=nx>deepEqual</span><span class=p>(</span>
  <span class=nx>iterator</span><span class=p>.</span><span class=nx>next</span><span class=p>().</span><span class=nx>value</span><span class=p>,</span>
  <span class=nx>call</span><span class=p>(</span><span class=nx>Api</span><span class=p>.</span><span class=nx>fetch</span><span class=p>,</span> <span class=s1>&#39;/products&#39;</span><span class=p>),</span>
  <span class=s2>&quot;fetchProducts should yield an Effect call(Api.fetch, &#39;./products&#39;)&quot;</span>
<span class=p>)</span>
</pre></div> </td></tr></table> <p>Executing the real service during tests is neither a viable nor practical approach, so we have to mock the <code>Api.fetch</code> function, i.e. we'll have to replace the real function with a fake one which doesn't actually run the AJAX request but only checks that we've called <code>Api.fetch</code> with the right arguments ('/products' in our case). What we actually need is just to make sure the <code>fetchProducts</code> task yields a call with the right function and the right arguments.</p> <p>Instead of invoking the asynchronous function directly from inside the Generator, we can yield only a description of the function invocation. i.e. We'll simply yield an object which looks like</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6
7</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// Effect -&gt; call the function Api.fetch with `./products` as argument</span>
<span class=p>{</span>
  <span class=nx>CALL</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>fn</span><span class=o>:</span> <span class=nx>Api</span><span class=p>.</span><span class=nx>fetch</span><span class=p>,</span>
    <span class=nx>args</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;./products&#39;</span><span class=p>]</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Put another way, the Generator will yield plain Objects containing instructions, and the <code>redux-saga</code> middleware will take care of executing those instructions and giving back the result of their execution to the Generator. This way, when testing the Generator, all we need to do is to check that it yields the expected instruction by doing a simple deepEqual on the yielded Object.</p> <h2 id=effect-creators>Effect creators<a class=headerlink href=#effect-creators title="Permanent link">&para;</a></h2> <blockquote> <p>Each function below returns a plain JavaScript object and does not perform any execution. The execution is performed by the middleware during the Iteration process. The middleware examines each Effect description and performs the appropriate action.</p> </blockquote> <h3 id=what-is-blocking-effect-and-non-blocking-effect>What is blocking effect and non blocking effect<a class=headerlink href=#what-is-blocking-effect-and-non-blocking-effect title="Permanent link">&para;</a></h3> <p>Effect which suspends the generator function and wait for the result to get is called <strong>blocking effect</strong>, whereas effect which does not suspend generator function and move to next statement immediately is called <strong>non blocking effect</strong>.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <ul> <li>put(action) - Non-blocking</li> <li>put.resolve(action) - Blocking</li> </ul> </div> <h3 id=takepattern>take(pattern)<a class=headerlink href=#takepattern title="Permanent link">&para;</a></h3> <blockquote> <p>Suspend the generator until matching action is dispatched - <strong>Blocking</strong></p> </blockquote> <p>Creates an Effect description that instructs the middleware to wait for a specified action on the Store. The Generator is suspended until an action that matches pattern is dispatched.</p> <p>Let see how something written using <code>takeEvery</code> can also be written in <code>take</code>.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>//### Using takeEvery</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>select</span><span class=p>,</span> <span class=nx>takeEvery</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;redux-saga/effects&#39;</span><span class=p>;</span>

<span class=kd>function</span><span class=o>*</span> <span class=nx>worker</span><span class=p>(</span><span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
  <span class=kr>const</span> <span class=nx>state</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>select</span><span class=p>();</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=nx>action</span><span class=p>);</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;state after&#39;</span><span class=p>,</span> <span class=nx>state</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=o>*</span> <span class=nx>watcher</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>yield</span> <span class=nx>takeEvery</span><span class=p>(</span><span class=s1>&#39;SOME_ACTION&#39;</span><span class=p>,</span> <span class=nx>worker</span><span class=p>);</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>//### Using take</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>select</span><span class=p>,</span> <span class=nx>take</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;redux-saga/effects&#39;</span><span class=p>;</span>

<span class=c1>// Note how we&#39;re running an endless loop while (true).</span>
<span class=c1>// Remember, this is a Generator function, which doesn&#39;t have a</span>
<span class=c1>// run-to-completion behavior. Our Generator will block on each</span>
<span class=c1>// iteration waiting for an action to happen.</span>
<span class=kd>function</span><span class=o>*</span> <span class=nx>worker</span><span class=p>()</span> <span class=p>{</span>
  <span class=c1>// We need while endless loop because</span>
  <span class=c1>// we want redux saga to listen to action</span>
  <span class=c1>// mutiple times. After listening for first time</span>
  <span class=c1>// the control again goes back to `take` for</span>
  <span class=c1>// future action.</span>
  <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>action</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>take</span><span class=p>(</span><span class=s1>&#39;SOME_ACTION&#39;</span><span class=p>);</span>
    <span class=kr>const</span> <span class=nx>state</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>select</span><span class=p>();</span>

    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=nx>action</span><span class=p>);</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;state after&#39;</span><span class=p>,</span> <span class=nx>state</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>function</span><span class=o>*</span> <span class=nx>watcher</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>yield</span> <span class=nx>worker</span><span class=p>();</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p><strong>Using <code>take</code>, you can have more control over the flow of saga.</strong> You can choose how many times you want to handle specific action.</p> <p>As a simple example, suppose that in our Todo application, we want to watch user actions and show a congratulation message after the user has created his first three todos.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>take</span><span class=p>,</span> <span class=nx>put</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;redux-saga/effects&#39;</span><span class=p>;</span>

<span class=kd>function</span><span class=o>*</span> <span class=nx>watchFirstThreeTodosCreation</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>action</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>take</span><span class=p>(</span><span class=s1>&#39;TODO_CREATED&#39;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>yield</span> <span class=nx>put</span><span class=p>({</span><span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;SHOW_CONGRATULATION&#39;</span><span class=p>});</span>
<span class=p>}</span>

<span class=kd>function</span><span class=o>*</span> <span class=nx>watcher</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>yield</span> <span class=nx>watchFirstThreeTodosCreation</span><span class=p>();</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Instead of a <code>while (true)</code>, we're running a <code>for</code> loop, which will iterate only three times. After taking the first three <code>TODO_CREATED</code> actions, <code>watchFirstThreeTodosCreation</code> will cause the application to display a congratulation message then terminate. This means the Generator will be garbage collected and no more observation will take place.</p> <h3 id=forkfn-args>fork(fn, ...args)<a class=headerlink href=#forkfn-args title="Permanent link">&para;</a></h3> <blockquote> <p>Like a <code>call</code> which execute the <code>fn</code> but <strong>Non blocking</strong></p> </blockquote> <h4 id=note>Note<a class=headerlink href=#note title="Permanent link">&para;</a></h4> <ul> <li>All forked (child) tasks are attached to parent (function which invoke <code>fork</code>). When the parent terminates the execution of its own body of instructions, it will wait for all forked tasks to terminate before returning.</li> <li>If any child forked task raises an uncaught error, then the parent task will abort with the child Error, and the whole Parent's execution tree (i.e. forked (child) tasks + the main (parent) task represented by the parent's body if it's still running) will be cancelled.</li> <li>Cancellation of any forked (child) Task will automatically cancel all forked tasks that are still executing.</li> </ul> <h4 id=call-vs-fork>call vs. fork<a class=headerlink href=#call-vs-fork title="Permanent link">&para;</a></h4> <p><code>call</code> is blocking and <code>fork</code> is non blocking. Look at the example below:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kd>function</span><span class=o>*</span> <span class=nx>worker</span><span class=p>()</span> <span class=p>{</span>
  <span class=c1>// execute and then generator is suspended</span>
  <span class=c1>// untill get the posts</span>
  <span class=kr>const</span> <span class=nx>posts</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>call</span><span class=p>(</span><span class=nx>fetchApi</span><span class=p>,</span> <span class=s1>&#39;/posts&#39;</span><span class=p>);</span>
  <span class=c1>// now execute and then generator is suspended</span>
  <span class=c1>// untill get the comments</span>
  <span class=kr>const</span> <span class=nx>comments</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>call</span><span class=p>(</span><span class=nx>fetchApi</span><span class=p>,</span> <span class=s1>&#39;/comments&#39;</span><span class=p>);</span>

  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>posts</span><span class=p>);</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>comments</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>//### fork</span>
<span class=kd>function</span><span class=o>*</span> <span class=nx>worker</span><span class=p>()</span> <span class=p>{</span>
  <span class=c1>// execute and move to next statement immediatelly</span>
  <span class=c1>// no waiting for result from api</span>
  <span class=kr>const</span> <span class=nx>posts</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>fork</span><span class=p>(</span><span class=nx>fetchApi</span><span class=p>,</span> <span class=s1>&#39;/posts&#39;</span><span class=p>);</span>
  <span class=c1>// execute and move to next statement immediatelly</span>
  <span class=c1>// no waiting for result from api</span>
  <span class=kr>const</span> <span class=nx>comments</span> <span class=o>=</span> <span class=k>yield</span> <span class=nx>fork</span><span class=p>(</span><span class=nx>fetchApi</span><span class=p>,</span> <span class=s1>&#39;/comments&#39;</span><span class=p>);</span>

  <span class=c1>// not get actual post and comment but the</span>
  <span class=c1>// Effect&#39;s description object in `post` and</span>
  <span class=c1>// `comment` variables.</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>posts</span><span class=p>);</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>comments</span><span class=p>)</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <h3 id=spawnfn-args>spawn(fn, ...args)<a class=headerlink href=#spawnfn-args title="Permanent link">&para;</a></h3> <blockquote> <p>Same as <code>fork</code> but creates a detached task. Which are independent of parent which invoke them.</p> </blockquote> <ul> <li>The parent will not wait for detached tasks to terminate before returning as in <code>fork</code>.</li> <li>Child tasks are completely independents of handling error and cancellation.</li> </ul> <h4 id=fork-vs-spawn>fork vs. spawn<a class=headerlink href=#fork-vs-spawn title="Permanent link">&para;</a></h4> <p><code>fork</code> and <code>spawn</code> will both return Task objects. Forked tasks are attached to parent, whereas spawned tasks are detached from the parent. If you see how errors are handled in <code>fork</code> and <code>spawn</code>, you can make better choices. Let se how:</p> <p>In <code>fork</code> if any child task raise an error then that error is bubbled up to parent and also it teminates the execution of all other childrens. Where as in case of <code>spawn</code>, if any of the child raises an error then other children remain unaffected. It is the duty of child task to handle error on its own than bubble to parent.</p> <p>Based on above, you could, use <code>fork</code> for "mission critical" tasks, i.e. "if this task fails, please crash the whole app", and spawn for "not critical" tasks, i.e. "if this task fails, do not propagate the error to the parent" and let the app keep running.</p> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Abhay Garg </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>